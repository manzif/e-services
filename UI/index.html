<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>E-services | Welcome</title>
    <link rel="stylesheet" href="./css/style.css" />
  </head>
  <body>
    <header>
      <div class="container">
        <div id="branding">
          <h1><span class="highlight">E</span>-Service</h1>
        </div>
        <nav>
          <ul>
            <li class="current"><a href="index.html">Home</a></li>
            <li><a href="./pages/services.html">SERvices</a></li>
            <li><a href="./pages/about.html">About</a></li>
          </ul>
        </nav>
      </div>
    </header>
    <section id="showcase">
      <div class="container">
        <h1>Best Services at a Fair Price</h1>
        <p>
          Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce
          bibendum eu risus a auctor. Vestibulum id mi interdum, tincidunt
          sapien nec, pulvinar tortor. Suspendisse sit amet pellentesque ipsum,
          sed euismod mi. Nam nec enim et arcu molestie iaculis vel a magna.
          Quisque rhoncus orci urna, vitae tempus eros convallis nec. Integer
          auctor ut enim vitae eleifend. Integer in quam eu lectus maximus
          commodo. Etiam sit amet ante vel nulla hendrerit pulvinar. Nullam
          lacinia faucibus ante non dictum.
        </p>
      </div>
    </section>
    <section id="subscription">
      <div class="container">
        <div>
          <h1>Create account to our E-services</h1>
          <form id="signup-form">
            <div id="error-msg2" class="error-msg"></div>
            <div id="success-msg2" class="success-msg"></div>
            <input
              type="text"
              placeholder="Enter Your Names"
              name="name"
              id="name"
            />
            <input
              type="email"
              placeholder="Enter Email ..."
              name="email"
              id="email"
            />
            <button type="submit" class="button_1">Save</button>
          </form>
        </div>
      </div>
    </section>
    <section id="service">
      <div class="container" id="services"></div>
    </section>
    <footer>
      <a href="./pages/login.html">Administration</a>
      <p>E-services, copyright &copy; 2019</p>
    </footer>
    <script>
      document.getElementById('signup-form').addEventListener('submit', signup);

      function signup(e) {
        e.preventDefault();

        let fullname = document.getElementById('name').value;
        let email = document.getElementById('email').value;
        let error_msg = document.getElementById('error-msg2');
        let success_msg = document.getElementById('success-msg2');

        fetch('http://localhost:5000/api/users', {
          method: 'POST',
          headers: {
            Accept: 'application/json, text/plain, */*',
            'Content-type': 'application/json'
          },
          body: JSON.stringify({
            fullname: fullname,
            email: email
          })
        })
          .then(res => res.json())
          .then(data => {
            if (data.status !== 201) {
              error_msg.style.display = 'block';
              error_msg.innerHTML = data.error;
            } else {
              success_msg.style.display = 'block';
              success_msg.innerHTML = data.message;
            }
            console.log(data);
          });
      }
    </script>
    <script>
      let services = document.getElementById('services');
      fetch('http://localhost:5000/api/services', {
        method: 'GET',
        headers: {
          Accept: 'application/json, text/plain, */*',
          'Content-type': 'application/json'
        }
      })
        .then(res => res.json())
        .then(data => {
          console.log(data);
          data.forEach(function(service) {
            services.innerHTML += `<div class="service1">
          <img src="${service.image}" />
          <h3><a href="./pages/painting.html">${service.title}</a></h3>
          <p>${service.description}</p>
        </div>`;
          });
        });
    </script>
  </body>
</html>
